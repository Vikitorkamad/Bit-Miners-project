<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css"> 
    <title>A Minecraft Movie</title>
</head>

<!-- BARRA DE COOKIES -->
<div id="cookie-bar">
    <p>
      O site <strong>bitMiners</strong> usa cookies e outras tecnologias semelhantes para melhorar a sua experiência, personalizar conteúdo e anúncios, oferecer recursos de mídia social e analisar nosso tráfego.  
      Ao continuar navegando, você concorda com essas condições. Para mais informações, acesse nossa 
      <a href="seguranca-e-privacidade.html">Política de Privacidade</a>.
    </p>
  <div id="cookie-overlay" >

      <div>
        <p>Você precisa aceitar os cookies para usar o site.</p>
        <p>
          Para mais informações, consulte nossa 
          <a href="seguranca-e-privacidade.html">Política de Segurança e Privacidade</a>.
        </p>
        <br>
        <button onclick="aceitarCookies()">Aceitar cookies</button>
      </div>
  </div>
  </div>

<body>

<main>
    <header>
        <div class="topo">
            <img src="./img/topo.png" alt="">
        </div>
    </header>

    <section>
        <h2>Deixe a sua opinião sobre Um Filme Minecraft e ganhe um brinde</h2>
        <p>
            Assista ao filme, deixe sua opinião e ganhe prêmios exclusivos no Minecraft! Todos que
            participarem ganham um código para resgatar uma capa no jogo, e os 5 comentários mais
            criativos podem ganhar ingressos para o próximo filme! O comentário mais curtido ganha um 
            bônus colecionável do Creeper!
        </p>
        <div class="imaagens">
            <img src="./img/capa.png" alt="Capa" class="img1">
            <img src="./img/abelha.png" alt="Abelha" class="img2">
            <img src="./img/bloco.png" alt="Bloco" class="img3">
            <img src="./img/abelha.png" alt="Outra Abelha" class="img4">
        </div>
        
        <iframe 
        width="560"
        height="315"
        src="https://www.youtube.com/embed/3IVPHxs4NoM?si=t9HrLX68M-8WLln3"
        title="YouTube video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen>
        </iframe>
    </section>

    <section name="comentarios">
        <h2>Melhores Comentários</h2>
        <div class="comentarios">
            <div class="ranking">
                <h3>1º lugar</h3>
                <div id="sla">
                    <p><strong><img src="./img/coment1.jpg" alt="Avatar" /> BlocoMaster</strong></p>
                    <p>
                        Explodiu mais que TNT! Esse filme foi uma aventura épica!
                        <span class="likes">
                          <span class="likes-count">81</span>
                          <span class="fa fa-star"></span>
                        </span>
                      </p>
                </div>
            </div>

            <div class="ranking">
                <h3>2º lugar</h3>
                <div id="sla">
                    <p><strong><img src="./img/coment1.jpg" alt="Avatar" /> CreeperK1ng</strong></p>
                    <p>
                        Finalmente um filme que atende o que é um verdadeiro miner!
                        <span class="likes">
                            <span class="likes-count">94</span>
                            <span class="fa fa-star"></span>
                        </span>
                    </p>
                </div>
            </div>
            
            <div class="ranking">
                <h3>3º lugar</h3>
                <div id="sla">
                    <p><strong><img src="./img/coment1.jpg" alt="Avatar" /> SteveCraftado</strong></p>
                    <p>
                        Se esse filme fosse um item, seria encantado!
                        <span class="likes">
                            <span class="likes-count">68</span>
                            <span class="fa fa-star"></span>
                        </span>
                    </p>
                </div>
            </div>
            
            <div class="ranking">
                <h3>4º lugar</h3>
                <div id="sla">
                    <p><strong><img src="./img/coment1.jpg" alt="Avatar" /> AbelhaPixelada</strong></p>
                    <p>
                        Saí do cinema querendo construir tudo que vi no filme!
                        <span class="likes">
                            <span class="likes-count">94</span>
                            <span class="fa fa-star"></span>
                        </span>
                    </p>
                </div>
            </div>
            
            <div class="ranking">
                <h3>5º lugar</h3>
                <div id="sla">
                    <p><strong><img src="./img/coment1.jpg" alt="Avatar" /> RedstoneRider</strong></p>
                    <p>
                        Mais divertido que tentar dormir com um monstro por perto!
                        <span class="likes">
                            <span class="likes-count">62</span>
                            <span class="fa fa-star"></span>
                        </span>
                    </p>
                </div>
            </div>

        </div>
    </section>

    <section>
        <p id="texto-tempo">o tempo está acabando. DEIXE SEU COMENTÁRIO!!!</p>
        <p id="tempo">30:05:59:25</p>
        <h2>Deixe seu comentário aqui</h2>
        <div class="form-box">
            <div class="form-content">
                <form id="envioform" method="POST">
                    <input type="email" placeholder="Seu e-mail:" id="email" name="email" required>
                    <input type="text" placeholder="Nome de usuário visível:" id="username" name="username" required>
                    <textarea id="comment" placeholder="Comentário:" name="comment" rows="5" required></textarea>
                    <button type="submit">Enviar</button>
                </form>
            </div>
        </div>
    </section>
    <section>
        <h2>Veja Comentários!</h2>
        <button class="filter-button">Filtros <span class="arrow">▼</span></button>
        <div class="comments-grid">

            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>Neth3rSlayer</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Nunca pensei que blocos pudessem emocionar tanto. Chocante!</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>AlexMineiro</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Esse filme é o Nether das emoções. Quero mais!</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>EnderLorde</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Me senti lembrando diamantes de nostalgia em cada cena.</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>CraftBoy2000</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Melhor que derrotar o Ender Dragon sem armadura!</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>TNTnaVé0ia</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Quem diria que filmes de blocos quadrados iam me deixar tão recordavelmente feliz?</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>PixeLeo</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Personagens carismáticos, roteiro envolvente e punição heroica!</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>GolemAmigo</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>O filme é como uma picareta de netherite: forte e inesquecível!</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>NetherWalker</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Simplesmente INCRIVEL</p>
                </div>
            </div>
            
            <div class="comment-box">
                <img src="./img/coment.png" alt="Avatar" class="avatar" />
                <div class="comment-content">
                    <div class="comment-header">
                        <strong>GolemAmigo</strong>
                        <span class="fa fa-star"></span>
                    </div>
                    <p>Assisti umas cinco vezes e ainda acho maravilhoso</p>
                </div>
            </div>
            

        </div>
    </section>
    

    <h4 id="h4">Não recebeu seu código por e-mail?</h4>
    <div class="reenvio">
        <p>nos repasse seu email que nossa equipe de suporte irá averiguar</p>
        <form action="submit_comment.php" method="POST">
            <input type="email" id="email" name="email" placeholder="Seu e-mail:" required>
            <button type="submit">Enviar</button>
        </form>
    </div>
</main>

</body>
</html>
<script>
    let dias = 30, horas = 5, minutos = 59, segundos = 25;
  
    function atualizarTempo() {

      if (segundos > 0) {
        segundos--;
      } else {
        segundos = 59;
        if (minutos > 0) {
          minutos--;
        } else {
          minutos = 59;
          if (horas > 0) {
            horas--;
          } else {
            horas = 23;
            if (dias > 0) {
              dias--;

              clearInterval(contador);
              document.getElementById("texto-tempo").innerText = "O TEMPO ACABOU!";
              return;
            }
          }
        }
      }

      document.getElementById("tempo").innerText =
        String(dias).padStart(2, '0') + ":" +
        String(horas).padStart(2, '0') + ":" +
        String(minutos).padStart(2, '0') + ":" +
        String(segundos).padStart(2, '0');
    }

    let contador = setInterval(atualizarTempo, 1000);

// Função para definir o valor do cookie
function setCookie(nome, valor, dias) {
    const d = new Date();
    d.setTime(d.getTime() + (dias * 24 * 60 * 60 * 1000)); // Definindo o tempo de expiração
    const expires = "expires=" + d.toUTCString();
    document.cookie = nome + "=" + valor + ";" + expires + ";path=/";
}

// Função para obter o valor do cookie
function getCookie(nome) {
    const nomeEQ = nome + "=";
    const ca = document.cookie.split(';');
    for (let c of ca) {
        while (c.charAt(0) === ' ') c = c.substring(1);
        if (c.indexOf(nomeEQ) === 0) return c.substring(nomeEQ.length, c.length);
    }
    return null;
}

// Função para aceitar os cookies
function aceitarCookies() {
    setCookie("cookiesConsent", "aceito", 365); // Marca o consentimento
    document.getElementById("cookie-bar").style.display = "none"; // Oculta a barra de cookies
    document.getElementById("cookie-overlay").style.display = "none"; // Oculta o overlay
}

// Função para rejeitar os cookies
function rejeitarCookies() {
    setCookie("cookiesConsent", "rejeitado", 365); // Marca o consentimento como rejeitado
    document.getElementById("cookie-bar").style.display = "none"; // Oculta a barra de cookies
    document.getElementById("cookie-overlay").style.display = "flex"; // Exibe o overlay
}

// Função para verificar o cookie ao carregar a página
window.onload = function () {
    const consent = getCookie("cookiesConsent"); // Verifica o estado do cookie

    if (consent === "aceito") {
        // Se o cookie foi aceito, não mostra o overlay nem a barra
        document.getElementById("cookie-bar").style.display = "none";
        document.getElementById("cookie-overlay").style.display = "none";
    } else if (consent === "rejeitado") {
        // Se o cookie foi rejeitado, exibe o overlay
        document.getElementById("cookie-overlay").style.display = "flex";
    } else {
        // Se o consentimento não foi dado, exibe o overlay e a barra
        document.getElementById("cookie-bar").style.display = "block";
        document.getElementById("cookie-overlay").style.display = "flex";
    }
};

document.addEventListener("DOMContentLoaded", function () {
    const stars = document.querySelectorAll(".fa-star");
    stars.forEach(function (star, index) {
        const likesSpan = star.parentElement.querySelector(".likes-count"); // assume que o span.likes vem antes da estrela
        const starState = getCookie("starState" + index);

        if (starState === "clicked") {
            star.classList.add("checked");
        }

        star.addEventListener("click", function () {
            const isChecked = this.classList.toggle("checked");
            let likes = parseInt(likesSpan.textContent, 10);

            if (isChecked) {
                likes += 1;
                setCookie("starState" + index, "clicked", 365);
            } else {
                likes = Math.max(0, likes - 1); // evita likes negativos
                setCookie("starState" + index, "unclicked", 365);
            }

            likesSpan.textContent = likes;
        });
    });
});

document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById('envioform');
  
    form.addEventListener('submit', async (e) => {
      e.preventDefault(); // Impede o reload da página
  
      // Lê os valores dos inputs
      const email = document.getElementById('email').value.trim();
      const username = document.getElementById('username').value.trim();
      const comment = document.getElementById('comment').value.trim();
  
      // Monta o payload
      const payload = { email, username, comment };
  
      try {
        const res = await fetch('/api/insert', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload)
        });
  
        if (res.ok) {
          const json = await res.json();
          alert('Comentário enviado com sucesso! ID: ' + json.insertId);
          form.reset(); // limpa o formulário
        } else {
          const err = await res.text();
          console.error('Resposta do servidor:', err);
          alert('Falha ao enviar comentário: ' + res.status);
        }
      } catch (error) {
        console.error('Erro de conexão:', error);
        alert('Não foi possível comunicar com o servidor.');
      }
    });
  });
  </script>
